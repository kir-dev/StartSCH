@page "/openings"
@using StartSch.Services
@inject Db Db
@inject InterestService InterestService

<h1 style="border-bottom: var(--startsch-sys-border-dotted); border-color: var(--md-sys-color-tertiary); color: var(--md-sys-color-tertiary)">Nyit√°sok</h1>

@foreach (var opening in _openings)
{
    <article>
        <EventPreview Event="@opening"/>
    </article>
}

@code {
    private List<PincerOpening> _openings = [];

    protected override async Task OnInitializedAsync()
    {
        await InterestService.LoadIndex;
        _openings = await Db.PincerOpenings
            .Where(o => o.End != null)
            .OrderByDescending(o => o.Start)
            .Include(o => o.EventCategories)
            .ToListAsync();
    }

}
